import"./modulepreload-polyfill-3cfb730f.js";import{p as P,q as v,r as x,V as C,R as T,d as b,s as I,W as _,C as F,S as j,t as z,P as G,D as k,A as O,G as H,u as S,f as D,v as N,w as q,i as R,x as B,a as L,y as W,z as $,I as U}from"./three.module-57b44d7c.js";import{g as f}from"./index-4db78ffb.js";class V extends P{constructor(t){super(t)}load(t,o,n,c){const r=this,i=new v(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(t,function(e){const s=r.parse(JSON.parse(e));o&&o(s)},n,c)}parse(t){return new K(t)}}class K{constructor(t){this.isFont=!0,this.type="Font",this.data=t}generateShapes(t,o=100){const n=[],c=X(t,o,this.data);for(let r=0,i=c.length;r<i;r++)n.push(...c[r].toShapes());return n}}function X(u,t,o){const n=Array.from(u),c=t/o.resolution,r=(o.boundingBox.yMax-o.boundingBox.yMin+o.underlineThickness)*c,i=[];let e=0,s=0;for(let l=0;l<n.length;l++){const m=n[l];if(m===`
`)e=0,s-=r;else{const p=J(m,c,e,s,o);e+=p.offsetX,i.push(p.path)}}return i}function J(u,t,o,n,c){const r=c.glyphs[u]||c.glyphs["?"];if(!r){console.error('THREE.Font: character "'+u+'" does not exists in font family '+c.familyName+".");return}const i=new x;let e,s,l,m,p,g,A,w;if(r.o){const a=r._cachedOutline||(r._cachedOutline=r.o.split(" "));for(let d=0,y=a.length;d<y;)switch(a[d++]){case"m":e=a[d++]*t+o,s=a[d++]*t+n,i.moveTo(e,s);break;case"l":e=a[d++]*t+o,s=a[d++]*t+n,i.lineTo(e,s);break;case"q":l=a[d++]*t+o,m=a[d++]*t+n,p=a[d++]*t+o,g=a[d++]*t+n,i.quadraticCurveTo(p,g,l,m);break;case"b":l=a[d++]*t+o,m=a[d++]*t+n,p=a[d++]*t+o,g=a[d++]*t+n,A=a[d++]*t+o,w=a[d++]*t+n,i.bezierCurveTo(p,g,A,w,l,m);break}}return{offsetX:r.ha*t,path:i}}window.addEventListener("DOMContentLoaded",()=>{const u=new h;u.load().then(()=>{u.init(),u.render()})},!1);class h{static get CAMERA_PARAM(){return{fovy:45,aspect:window.innerWidth/window.innerHeight,near:2,far:8,x:-1,y:2,z:7,lookAt:new C(0,0,0)}}static get RENDERER_PARAM(){return{clearColor:2302240,width:window.innerWidth,height:window.innerHeight}}static get DIRECTIONAL_LIGHT_PARAM(){return{color:16777215,intensity:20,x:1.5,y:2,z:2.5}}static get AMBIENT_LIGHT_PARAM(){return{color:16777215,intensity:.2}}static get MATERIAL_PARAM(){return{color:16777215}}static get POINT_MATERIAL_PARAM(){return{color:16777215,size:.2,sizeAttenuation:!0}}static get TEXT_MATERIAL_PARAM(){return{color:16777215}}static get FOG_PARAM(){return{fogColor:2302240,fogNear:3,fogFar:8.5}}constructor(){this.renderer,this.scene,this.camera,this.controls,this.directionalLight,this.ambientLight,this.axesHelper,this.timeFrame,this.line,this.lineGeometry,this.lineMaterial,this.linePoints=[],this.points,this.pointsGeometry,this.pointsMaterial,this.planeArray=[],this.isCliked=!1,this.object,this.objectCopy,this.render=this.render.bind(this),this.apiKey="0296d9cfab50bb2bb831354611c78819",this.movieList,window.addEventListener("resize",()=>{this.renderer.setSize(window.innerWidth,window.innerHeight),this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix()},!1),this.raycaster=new T,window.addEventListener("pointermove",t=>{t.preventDefault();const o=t.clientX/window.innerWidth*2-1,n=t.clientY/window.innerHeight*2-1,c=new b(o,-n);this.raycaster.setFromCamera(c,this.camera);const r=this.raycaster.intersectObjects(this.planeArray);if(r.length>0&&!this.isCliked){const e=r[0].object,s=e.position.z+this.timeFrame.position.z;s>1.5&&s<3.75&&(f.to(e.position,{duration:.5,y:.3}),document.querySelector(".movie-title").innerHTML=e.userData.original_title+" ("+e.userData.release_date.slice(0,4)+")"),this.planeArray.forEach(l=>{l!==e&&f.to(l.position,{duration:.5,y:0})})}else this.isCliked||this.planeArray.forEach(i=>{f.to(i.position,{duration:.5,y:0})});r.length==0&&!this.isCliked&&(document.querySelector(".movie-title").innerHTML="")},!1),window.addEventListener("click",t=>{const o=t.clientX/window.innerWidth*2-1,n=t.clientY/window.innerHeight*2-1,c=new b(o,-n);this.raycaster.setFromCamera(c,this.camera);const r=this.raycaster.intersectObjects(this.planeArray);if(r.length>0&&!this.isCliked){t.preventDefault();const i=r[0];this.object=i.object,this.objectCopy=this.object.clone();const e=this.object.position.z+this.timeFrame.position.z;if(e>1.5&&e<3.75){!this.object.userData.overview==""?document.querySelector(".movie-overview").innerHTML=this.object.userData.overview:document.querySelector(".movie-overview").innerHTML="No overview";let s=f.timeline({onStart:()=>this.isCliked=!0});const l=.5,m=2;s.to(this.object.position,{duration:l,x:1.5,y:1.25,z:2.5-this.timeFrame.position.z},0),s.to(this.object.rotation,{duration:l,x:Math.PI*2-.1,y:-.4},0),s.to(this.object.scale,{duration:l,x:m,y:m},0),s.to(".movie-info-container",{duration:l,y:110},0),s.to(".movie-overview-container",{duration:l,opacity:1})}}else if(this.isCliked){let i=f.timeline({onComplete:()=>this.isCliked=!1});const e=.5,s=1;i.to(this.object.position,{duration:e,x:this.objectCopy.position.x,y:0,z:this.objectCopy.position.z},0),i.to(this.object.rotation,{duration:e,x:-Math.PI*2,y:this.objectCopy.rotation.y},0),i.to(this.object.scale,{duration:e,x:s,y:s},0),i.to(".movie-info-container",{duration:e,y:-125},0),i.to(".movie-overview-container",{duration:e,opacity:0,onComplete:()=>{document.querySelector(".movie-overview").innerHTML=""}},0)}},!1),window.addEventListener("wheel",t=>{const o=t.deltaY*.001;!this.isCliked&&this.timeFrame.position.z>-9&&this.timeFrame.position.z<2?this.timeFrame.position.z-=o:!this.isCliked&&this.timeFrame.position.z<-9&&t.deltaY<0?this.timeFrame.position.z-=o:!this.isCliked&&this.timeFrame.position.z>2&&t.deltaY>0&&(this.timeFrame.position.z-=o)})}async load(){this.movieList={"1960s":[],"1970s":[],"1980s":[],"1990s":[],"2000s":[],"2010s":[],"2020s":[]};for(let t=0;t<5;t++){const o=`https://api.themoviedb.org/3/search/movie?query=spider%20man&include_adult=false&language=en-US&page=${t+1}&region=US&api_key=${this.apiKey}`;(await(await fetch(o)).json()).results.filter(i=>i.original_language==="en"&&i.release_date!==""&&i.poster_path!==null).forEach(i=>{const e=i.release_date.slice(0,4);e>=1960&&e<1970?this.movieList["1960s"].push(i):e>=1970&&e<1980?this.movieList["1970s"].push(i):e>=1980&&e<1990?this.movieList["1980s"].push(i):e>=1990&&e<2e3?this.movieList["1990s"].push(i):e>=2e3&&e<2010?this.movieList["2000s"].push(i):e>=2010&&e<2020?this.movieList["2010s"].push(i):e>=2020&&e<2030&&this.movieList["2020s"].push(i)});for(const i in this.movieList)this.movieList[i].sort((e,s)=>e.release_date>s.release_date?1:-1)}}async loadTexture(t){const o=document.querySelector(".top-overlay"),n=document.querySelector(".bottom-overlay"),c=document.querySelector(".loading-bar"),r=new U(()=>{window.setTimeout(()=>{f.to(o,{ease:"power1.easeOut",duration:1,y:"-50vh",delay:1}),f.to(n,{ease:"power1.easeOut",duration:1,y:"50vh",delay:1}),c.classList.add("ended"),c.style.transform=""},500)},(i,e,s)=>{const l=e/s;c.style.transform=`scaleX(${l})`});return new Promise((i,e)=>{new I(r).load(t,s=>i(s),void 0,s=>e(s))})}init(){this.renderer=new _({antialias:!0}),this.renderer.setClearColor(new F(h.RENDERER_PARAM.clearColor)),this.renderer.setSize(h.RENDERER_PARAM.width,h.RENDERER_PARAM.height),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),document.querySelector("#webgl").appendChild(this.renderer.domElement),this.scene=new j,this.scene.fog=new z(h.FOG_PARAM.fogColor,h.FOG_PARAM.fogNear,h.FOG_PARAM.fogFar),this.camera=new G(h.CAMERA_PARAM.fovy,h.CAMERA_PARAM.aspect,h.CAMERA_PARAM.near,h.CAMERA_PARAM.far),this.camera.position.set(h.CAMERA_PARAM.x,h.CAMERA_PARAM.y,h.CAMERA_PARAM.z),this.camera.lookAt(h.CAMERA_PARAM.lookAt),this.directionalLight=new k(h.DIRECTIONAL_LIGHT_PARAM.color,h.DIRECTIONAL_LIGHT_PARAM.intensity),this.directionalLight.position.set(h.DIRECTIONAL_LIGHT_PARAM.x,h.DIRECTIONAL_LIGHT_PARAM.y,h.DIRECTIONAL_LIGHT_PARAM.z),this.scene.add(this.directionalLight),this.ambientLight=new O(h.AMBIENT_LIGHT_PARAM.color,h.AMBIENT_LIGHT_PARAM.intensity),this.scene.add(this.ambientLight),this.timeFrame=new H,this.pointsMaterial=new S(h.POINT_MATERIAL_PARAM),this.pointsGeometry=new D;const o=Object.keys(this.movieList).length,n=2,c=[];for(let s=0;s<o;s++){const m=s*n;c.push(-2.5,0,m)}const r=3,i=new N(new Float32Array(c),r);this.pointsGeometry.setAttribute("position",i),this.points=new q(this.pointsGeometry,this.pointsMaterial),this.scene.add(this.points),this.timeFrame.add(this.points),this.lineMaterial=new R(h.MATERIAL_PARAM),this.lineGeometry=new B(.01,.01,2*o,32),this.line=new L(this.lineGeometry,this.lineMaterial),this.scene.add(this.line),this.line.rotation.x=Math.PI/2,this.line.position.x=-2.5,this.line.position.z=o,this.timeFrame.add(this.line);const e=new W(.75,1);for(const[s,[l,m]]of Object.entries(Object.entries(this.movieList)))m.forEach((A,w)=>{const a=new L(e);a.position.set(w*.1-2,0,n*s),a.rotation.y=-Math.PI/3,a.userData=A,this.loadTexture(`https://image.tmdb.org/t/p/original/${A.poster_path}`).then(d=>{const y=new R({map:d});a.material=y,this.scene.add(a),this.timeFrame.add(a),this.planeArray.push(a)}).catch(d=>{console.error("Error loading texture:",d)})}),new V().load("/webglschool/fonts/helvetiker_regular.typeface.json",A=>{const w=new R(h.TEXT_MATERIAL_PARAM),a=l,d=A.generateShapes(a,.2),y=new $(d),M=new L(y,w);M.position.set(-2.5,0,n*s),M.rotation.y=-.1,y.computeBoundingBox();const E=-(y.boundingBox.max.x-y.boundingBox.min.x)-.2;y.translate(E,0,0),this.scene.add(M),this.timeFrame.add(M)});this.scene.add(this.timeFrame),this.timeFrame.position.z=2.01}render(){requestAnimationFrame(this.render),this.renderer.render(this.scene,this.camera)}}
